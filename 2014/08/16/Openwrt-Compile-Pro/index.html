<!DOCTYPE html>
<html lang="zh">
<head>
    <!-- so meta -->
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="HandheldFriendly" content="True">
    <meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=1">
    <meta name="description" content="摘要：这篇文章是 Openwrt 编译的学习笔记包括（1）Openwrt 基础入门（2）Openwrt 基础进阶（3）集成软件">
<meta name="keywords" content="Openwrt,编译">
<meta property="og:type" content="article">
<meta property="og:title" content="Openwrt 编译进阶">
<meta property="og:url" content="https://fjkfwz.github.io/2014/08/16/Openwrt-Compile-Pro/index.html">
<meta property="og:site_name" content="Sapientia et Virtus">
<meta property="og:description" content="摘要：这篇文章是 Openwrt 编译的学习笔记包括（1）Openwrt 基础入门（2）Openwrt 基础进阶（3）集成软件">
<meta property="og:locale" content="zh-Hans">
<meta property="og:updated_time" content="2017-12-25T14:28:22.378Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Openwrt 编译进阶">
<meta name="twitter:description" content="摘要：这篇文章是 Openwrt 编译的学习笔记包括（1）Openwrt 基础入门（2）Openwrt 基础进阶（3）集成软件">
    
    
        
          
              <link rel="shortcut icon" href="/images/favicon.ico">
          
        
        
          
            <link rel="icon" type="image/png" href="/images/favicon-192x192.png" sizes="192x192">
          
        
        
          
            <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon.png">
          
        
    
    <!-- title -->
    <title>Openwrt 编译进阶</title>
    <!-- styles -->
    <link rel="stylesheet" href="/css/style.css">
    <!-- rss -->
    
    
      <link rel="alternate" href="/atom.xml" title="Sapientia et Virtus" type="application/atom+xml">
    
</head>
<body>
    
      <div id="header-post">
  <a id="menu-icon" href="#"><i class="fa fa-bars fa-lg"></i></a>
  <a id="menu-icon-tablet" href="#"><i class="fa fa-bars fa-lg"></i></a>
  <a id="top-icon-tablet" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast')" style="display:none"><i class="fa fa-chevron-up fa-lg"></i></a>
  <span id="menu">
    <span id="nav">
      <ul>
         
          <li><a href="/">Home</a></li>
         
          <li><a href="/about/">About</a></li>
         
          <li><a href="/archives/">Writing</a></li>
         
          <li><a href="http://github.com/fjkfwz">Projects</a></li>
         
          <li><a href="/Search/">Search</a></li>
        
      </ul>
    </span>
    <br>
    <span id="actions">
      <ul>
        
        <li><a class="icon" href="/2014/08/16/Openwrt-Compiling/"><i class="fa fa-chevron-left" aria-hidden="true" onmouseover="$('#i-prev').toggle()" onmouseout="$('#i-prev').toggle()"></i></a></li>
        
        
        <li><a class="icon" href="/2014/08/12/Openwrt-SSH-PHP/"><i class="fa fa-chevron-right" aria-hidden="true" onmouseover="$('#i-next').toggle()" onmouseout="$('#i-next').toggle()"></i></a></li>
        
        <li><a class="icon" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast')"><i class="fa fa-chevron-up" aria-hidden="true" onmouseover="$('#i-top').toggle()" onmouseout="$('#i-top').toggle()"></i></a></li>
        <li><a class="icon" href="#"><i class="fa fa-share-alt" aria-hidden="true" onmouseover="$('#i-share').toggle()" onmouseout="$('#i-share').toggle()" onclick="$('#share').toggle();return false"></i></a></li>
      </ul>
      <span id="i-prev" class="info" style="display:none">Previous post</span>
      <span id="i-next" class="info" style="display:none">Next post</span>
      <span id="i-top" class="info" style="display:none">Back to top</span>
      <span id="i-share" class="info" style="display:none">Share post</span>
    </span>
    <br>
    <div id="share" style="display: none">
      <ul>
  <li><a class="icon" href="http://www.facebook.com/sharer.php?u=https://fjkfwz.github.io/2014/08/16/Openwrt-Compile-Pro/"><i class="fa fa-facebook" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="https://twitter.com/share?url=https://fjkfwz.github.io/2014/08/16/Openwrt-Compile-Pro/&text=Openwrt 编译进阶"><i class="fa fa-twitter" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://www.linkedin.com/shareArticle?url=https://fjkfwz.github.io/2014/08/16/Openwrt-Compile-Pro/&title=Openwrt 编译进阶"><i class="fa fa-linkedin" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="https://pinterest.com/pin/create/bookmarklet/?url=https://fjkfwz.github.io/2014/08/16/Openwrt-Compile-Pro/&is_video=false&description=Openwrt 编译进阶"><i class="fa fa-pinterest" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="mailto:?subject=Openwrt 编译进阶&body=Check out this article: https://fjkfwz.github.io/2014/08/16/Openwrt-Compile-Pro/"><i class="fa fa-envelope" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="https://getpocket.com/save?url=https://fjkfwz.github.io/2014/08/16/Openwrt-Compile-Pro/&title=Openwrt 编译进阶"><i class="fa fa-get-pocket" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://reddit.com/submit?url=https://fjkfwz.github.io/2014/08/16/Openwrt-Compile-Pro/&title=Openwrt 编译进阶"><i class="fa fa-reddit" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://www.stumbleupon.com/submit?url=https://fjkfwz.github.io/2014/08/16/Openwrt-Compile-Pro/&title=Openwrt 编译进阶"><i class="fa fa-stumbleupon" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://digg.com/submit?url=https://fjkfwz.github.io/2014/08/16/Openwrt-Compile-Pro/&title=Openwrt 编译进阶"><i class="fa fa-digg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://www.tumblr.com/share/link?url=https://fjkfwz.github.io/2014/08/16/Openwrt-Compile-Pro/&name=Openwrt 编译进阶&description=&lt;p&gt;&lt;strong&gt;摘要&lt;/strong&gt;：这篇文章是 Openwrt 编译的学习笔记包括（1）Openwrt 基础入门（2）Openwrt 基础进阶（3）集成软件&lt;br&gt;"><i class="fa fa-tumblr" aria-hidden="true"></i></a></li>
</ul>
    </div>
    <div id="toc">
      <ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#Openwrt-基础编译"><span class="toc-number">1.</span> <span class="toc-text"><a href="#Openwrt-&#x57FA;&#x7840;&#x7F16;&#x8BD1;" class="headerlink" title="Openwrt &#x57FA;&#x7840;&#x7F16;&#x8BD1;"></a>Openwrt &#x57FA;&#x7840;&#x7F16;&#x8BD1;</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#Openwrt-编译进阶"><span class="toc-number">2.</span> <span class="toc-text"><a href="#Openwrt-&#x7F16;&#x8BD1;&#x8FDB;&#x9636;" class="headerlink" title="Openwrt &#x7F16;&#x8BD1;&#x8FDB;&#x9636;"></a>Openwrt &#x7F16;&#x8BD1;&#x8FDB;&#x9636;</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#修改-WIFI-设置"><span class="toc-number">2.1.</span> <span class="toc-text"><a href="#&#x4FEE;&#x6539;-WIFI-&#x8BBE;&#x7F6E;" class="headerlink" title="&#x4FEE;&#x6539; WIFI &#x8BBE;&#x7F6E;"></a>&#x4FEE;&#x6539; WIFI &#x8BBE;&#x7F6E;</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#修改-LUCI"><span class="toc-number">2.2.</span> <span class="toc-text"><a href="#&#x4FEE;&#x6539;-LUCI" class="headerlink" title="&#x4FEE;&#x6539; LUCI"></a>&#x4FEE;&#x6539; LUCI</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#修改-LUCI-界面配置"><span class="toc-number">2.2.1.</span> <span class="toc-text"><a href="#&#x4FEE;&#x6539;-LUCI-&#x754C;&#x9762;&#x914D;&#x7F6E;" class="headerlink" title="&#x4FEE;&#x6539; LUCI &#x754C;&#x9762;&#x914D;&#x7F6E;"></a>&#x4FEE;&#x6539; LUCI &#x754C;&#x9762;&#x914D;&#x7F6E;</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#添加释放内存"><span class="toc-number">2.2.2.</span> <span class="toc-text"><a href="#&#x6DFB;&#x52A0;&#x91CA;&#x653E;&#x5185;&#x5B58;" class="headerlink" title="&#x6DFB;&#x52A0;&#x91CA;&#x653E;&#x5185;&#x5B58;"></a>&#x6DFB;&#x52A0;&#x91CA;&#x653E;&#x5185;&#x5B58;</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#在顶栏显示重启"><span class="toc-number">2.2.3.</span> <span class="toc-text"><a href="#&#x5728;&#x9876;&#x680F;&#x663E;&#x793A;&#x91CD;&#x542F;" class="headerlink" title="&#x5728;&#x9876;&#x680F;&#x663E;&#x793A;&#x91CD;&#x542F;"></a>&#x5728;&#x9876;&#x680F;&#x663E;&#x793A;&#x91CD;&#x542F;</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#在顶栏显示备份-升级"><span class="toc-number">2.2.4.</span> <span class="toc-text"><a href="#&#x5728;&#x9876;&#x680F;&#x663E;&#x793A;&#x5907;&#x4EFD;-&#x5347;&#x7EA7;" class="headerlink" title="&#x5728;&#x9876;&#x680F;&#x663E;&#x793A;&#x5907;&#x4EFD;/&#x5347;&#x7EA7;"></a>&#x5728;&#x9876;&#x680F;&#x663E;&#x793A;&#x5907;&#x4EFD;/&#x5347;&#x7EA7;</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#修改配置文件"><span class="toc-number">2.3.</span> <span class="toc-text"><a href="#&#x4FEE;&#x6539;&#x914D;&#x7F6E;&#x6587;&#x4EF6;" class="headerlink" title="&#x4FEE;&#x6539;&#x914D;&#x7F6E;&#x6587;&#x4EF6;"></a>&#x4FEE;&#x6539;&#x914D;&#x7F6E;&#x6587;&#x4EF6;</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#修改-root-密码"><span class="toc-number">2.3.1.</span> <span class="toc-text"><a href="#&#x4FEE;&#x6539;-root-&#x5BC6;&#x7801;" class="headerlink" title="&#x4FEE;&#x6539; root &#x5BC6;&#x7801;"></a>&#x4FEE;&#x6539; root &#x5BC6;&#x7801;</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#修改路由连接数"><span class="toc-number">2.3.2.</span> <span class="toc-text"><a href="#&#x4FEE;&#x6539;&#x8DEF;&#x7531;&#x8FDE;&#x63A5;&#x6570;" class="headerlink" title="&#x4FEE;&#x6539;&#x8DEF;&#x7531;&#x8FDE;&#x63A5;&#x6570;"></a>&#x4FEE;&#x6539;&#x8DEF;&#x7531;&#x8FDE;&#x63A5;&#x6570;</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#修改主机名，设定时区"><span class="toc-number">2.3.3.</span> <span class="toc-text"><a href="#&#x4FEE;&#x6539;&#x4E3B;&#x673A;&#x540D;&#xFF0C;&#x8BBE;&#x5B9A;&#x65F6;&#x533A;" class="headerlink" title="&#x4FEE;&#x6539;&#x4E3B;&#x673A;&#x540D;&#xFF0C;&#x8BBE;&#x5B9A;&#x65F6;&#x533A;"></a>&#x4FEE;&#x6539;&#x4E3B;&#x673A;&#x540D;&#xFF0C;&#x8BBE;&#x5B9A;&#x65F6;&#x533A;</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#SAMBA-免密码访问"><span class="toc-number">2.3.4.</span> <span class="toc-text"><a href="#SAMBA-&#x514D;&#x5BC6;&#x7801;&#x8BBF;&#x95EE;" class="headerlink" title="SAMBA &#x514D;&#x5BC6;&#x7801;&#x8BBF;&#x95EE;"></a>SAMBA &#x514D;&#x5BC6;&#x7801;&#x8BBF;&#x95EE;</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#集成软件"><span class="toc-number">2.4.</span> <span class="toc-text"><a href="#&#x96C6;&#x6210;&#x8F6F;&#x4EF6;" class="headerlink" title="&#x96C6;&#x6210;&#x8F6F;&#x4EF6;"></a>&#x96C6;&#x6210;&#x8F6F;&#x4EF6;</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#添加-aria2，luci-添加，web-管理界面"><span class="toc-number">2.4.1.</span> <span class="toc-text"><a href="#&#x6DFB;&#x52A0;-aria2&#xFF0C;luci-&#x6DFB;&#x52A0;&#xFF0C;web-&#x7BA1;&#x7406;&#x754C;&#x9762;" class="headerlink" title="&#x6DFB;&#x52A0; aria2&#xFF0C;luci &#x6DFB;&#x52A0;&#xFF0C;web &#x7BA1;&#x7406;&#x754C;&#x9762;"></a>&#x6DFB;&#x52A0; aria2&#xFF0C;luci &#x6DFB;&#x52A0;&#xFF0C;web &#x7BA1;&#x7406;&#x754C;&#x9762;</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#添加将自己开发的程序"><span class="toc-number">2.4.2.</span> <span class="toc-text"><a href="#&#x6DFB;&#x52A0;&#x5C06;&#x81EA;&#x5DF1;&#x5F00;&#x53D1;&#x7684;&#x7A0B;&#x5E8F;" class="headerlink" title="&#x6DFB;&#x52A0;&#x5C06;&#x81EA;&#x5DF1;&#x5F00;&#x53D1;&#x7684;&#x7A0B;&#x5E8F;"></a>&#x6DFB;&#x52A0;&#x5C06;&#x81EA;&#x5DF1;&#x5F00;&#x53D1;&#x7684;&#x7A0B;&#x5E8F;</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#HG255D-个性化配置"><span class="toc-number">2.5.</span> <span class="toc-text"><a href="#HG255D-&#x4E2A;&#x6027;&#x5316;&#x914D;&#x7F6E;" class="headerlink" title="HG255D &#x4E2A;&#x6027;&#x5316;&#x914D;&#x7F6E;"></a>HG255D &#x4E2A;&#x6027;&#x5316;&#x914D;&#x7F6E;</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#开启-HG255D-编译"><span class="toc-number">2.5.1.</span> <span class="toc-text"><a href="#&#x5F00;&#x542F;-HG255D-&#x7F16;&#x8BD1;" class="headerlink" title="&#x5F00;&#x542F; HG255D &#x7F16;&#x8BD1;"></a>&#x5F00;&#x542F; HG255D &#x7F16;&#x8BD1;</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#make-menuconfig-配置"><span class="toc-number">2.5.2.</span> <span class="toc-text"><a href="#make-menuconfig-&#x914D;&#x7F6E;" class="headerlink" title="make menuconfig &#x914D;&#x7F6E;"></a>make menuconfig &#x914D;&#x7F6E;</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#开启-POWER-LED-状态指示灯"><span class="toc-number">2.5.3.</span> <span class="toc-text"><a href="#&#x5F00;&#x542F;-POWER-LED-&#x72B6;&#x6001;&#x6307;&#x793A;&#x706F;" class="headerlink" title="&#x5F00;&#x542F; POWER LED &#x72B6;&#x6001;&#x6307;&#x793A;&#x706F;"></a>&#x5F00;&#x542F; POWER LED &#x72B6;&#x6001;&#x6307;&#x793A;&#x706F;</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#使用-RA-MOD-软件源"><span class="toc-number">2.5.4.</span> <span class="toc-text"><a href="#&#x4F7F;&#x7528;-RA-MOD-&#x8F6F;&#x4EF6;&#x6E90;" class="headerlink" title="&#x4F7F;&#x7528; RA-MOD &#x8F6F;&#x4EF6;&#x6E90;"></a>&#x4F7F;&#x7528; RA-MOD &#x8F6F;&#x4EF6;&#x6E90;</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#添加自动挂载脚本"><span class="toc-number">2.5.5.</span> <span class="toc-text"><a href="#&#x6DFB;&#x52A0;&#x81EA;&#x52A8;&#x6302;&#x8F7D;&#x811A;&#x672C;" class="headerlink" title="&#x6DFB;&#x52A0;&#x81EA;&#x52A8;&#x6302;&#x8F7D;&#x811A;&#x672C;"></a>&#x6DFB;&#x52A0;&#x81EA;&#x52A8;&#x6302;&#x8F7D;&#x811A;&#x672C;</span></a></li></ol></li></ol></li></ol>
    </div>
  </span>
</div>
    
    <div class="content index width mx-auto px2 my4">
        
        <article class="post" itemscope itemtype="http://schema.org/BlogPosting">
  <header>
    <h1 class="posttitle" itemprop="name headline">
        Openwrt 编译进阶
    </h1>
    <div class="meta">
      <span class="author" itemprop="author" itemscope itemtype="http://schema.org/Person">
        <span itemprop="name">Sapientia et Virtus</span>
      </span>
      <div class="postdate">
        <time datetime="2014-08-16T00:00:00.000Z" itemprop="datePublished">Aug 16 2014</time>
    </div>
      <div class="article-tag">
        <i class="fa fa-tag"></i>
        <a class="tag-link" href="/tags/Openwrt/">Openwrt</a>, <a class="tag-link" href="/tags/编译/">编译</a>
    </div>
    </div>
  </header>
  
  <div class="content" itemprop="articleBody">
    <p><strong>摘要</strong>：这篇文章是 Openwrt 编译的学习笔记包括（1）Openwrt 基础入门（2）Openwrt 基础进阶（3）集成软件<br><a id="more"></a></p>
<hr>
<p>之前总喜欢在在写文章之前写一大段自己的光荣事迹，后来发现看别人这样写的文章是一件很蛋疼的事，毕竟这是一篇技术类文章，不是小学生日记。<br>好吧，这次直接进入正题，抱歉，又写了一段和本文内容无关的文字……<br>去年学校开始用 H3C 认证来限制我们上网，于是好奇心再次害死猫，本宫终于修成正果，误入 Openwrt 这个大坑，折腾 Openwrt 有一年多了，到了回馈社会的时候了，这篇文章写写 Openwrt 编译的一些高级配置（相对入门级编译教程而言），以 HG255D 为例。</p>
<hr>
<h1 id="Openwrt-基础编译"><a href="#Openwrt-基础编译" class="headerlink" title="Openwrt 基础编译"></a>Openwrt 基础编译</h1><p>这类文章一手一大把，精简的，详细的（多半是废话）都有，这里就简单的把一些指令写下</p>
<hr>
<pre><code>编译环境为 Ubuntu
# 升级组件包
sudo apt-get update
# 安装编译需要的组件
sudo apt-get install gcc g++ binutils patch bzip2 flex bison make autoconf gettext texinfo unzip sharutils subversion libncurses5-dev ncurses-term zlib1g-dev git-core gawk asciidoc libz-dev sphinxsearch libtool sphinx-common libssl-dev libsqlite3* intltool libiconv* gstreamer-0.10* glib2.0 libxml2-dev qemu
（*64位系统需安装 ia32-libs）
# 使用非 root 用户登录，建立 openwrt 目录
mkdir openwrt
# 进入 openwrt 目录
cd openwrt
# 下载 openwrt 源码
svn checkout svn://svn.openwrt.org/openwrt/trunk
# 赋予 trunk 目录权限
sudo chmod -R 777 trunk
# 进入 trunk 目录
cd trunk
# 更新最新源码
./scripts/feeds update -a
# 安装最新源码
./scripts/feeds install -a
# 更新版本号
svn up
# 进入编译菜单
make menuconfig
Y：选择 Y，该软件将被编译，并且加入到你的目标固件里；
M：选择 M，该软件包将会被编译，但不会被放入固件里。在需要它的时候，可以用 OPKG 软件包管理器进行安装；
N：选择 N，该软件包将不会被编译，也不会被安装进固件。
方向键是移动光标
回车键是确认
空格键是选择，可以代替 Y/M/N 键的使用
/:搜索
# 编译
make V=99
# 清除编译过程产生的临时文件
make clean
# 恢复编译环境
make defconfig
</code></pre><h1 id="Openwrt-编译进阶"><a href="#Openwrt-编译进阶" class="headerlink" title="Openwrt 编译进阶"></a>Openwrt 编译进阶</h1><p>其实按照上面的指令一路执行下来，你已经能够在/bin/$target 下找到刷机固件了,是不是很简单……</p>
<h2 id="修改-WIFI-设置"><a href="#修改-WIFI-设置" class="headerlink" title="修改 WIFI 设置"></a>修改 WIFI 设置</h2><p><em><code>package/kernel/mac80211/files/lib/wifi/mac80211.sh</code></em></p>
<pre><code>config wifi-device  radio$devidx
    option type     mac80211
    option channel  11
    option hwmode    11ng
    option path    &apos;10180000.wmac&apos;
    option htmode    HT20
    list ht_capab    GF
    list ht_capab    SHORT-GI-20
    list ht_capab    SHORT-GI-40
    list ht_capab    TX-STBC
    list ht_capab    RX-STBC12
    #  REMOVE THIS LINE TO ENABLE WIFI:
    option disabled 0
    option noscan 1
    option txpower 20
    option htmode HT40-

config wifi-iface
    option device   radio$devidx
    option network  lan
    option mode     ap
    # 自定义 SSID 为 MakeBlaze_MAC 后六位
    option ssid     MakeBlaze_$(cat /sys/class/ieee80211/${dev}/macaddress|awk -F &quot;:&quot; &apos;{print $4&quot;&quot;$5&quot;&quot;$6 }&apos;| tr a-z A-Z) 
    option encryption none
</code></pre><h2 id="修改-LUCI"><a href="#修改-LUCI" class="headerlink" title="修改 LUCI"></a>修改 LUCI</h2><h3 id="修改-LUCI-界面配置"><a href="#修改-LUCI-界面配置" class="headerlink" title="修改 LUCI 界面配置"></a>修改 LUCI 界面配置</h3><p><em><code>feeds/luci/modules/base/root/etc/config/luci</code></em></p>
<pre><code>config core main
    option resourcebase &apos;/luci-static/resources&apos;
    # 设置默认语言
    option lang &apos;zh_cn&apos;
    # 设置默认主题
    option mediaurlbase &apos;/luci-static/bootstrap&apos;

# 设置可选择的语言        
config internal languages
    option zh_cn &apos;chinese&apos;
    option en &apos;English&apos;
# 设置可选择的主题
config internal themes
    option Bootstrap &apos;/luci-static/bootstrap&apos;
</code></pre><h3 id="添加释放内存"><a href="#添加释放内存" class="headerlink" title="添加释放内存"></a>添加释放内存</h3><p><em><code>feeds/luci/modules/admin-full/luasrc/controller/admin/index.lua</code></em></p>
<pre><code>function index()
+    entry({&quot;admin&quot;, &quot;Free_Memory&quot;}, call(&quot;Free_Memory&quot;), _(&quot;释放内存&quot;), 75)
end

function Free_Memory()
    luci.util.exec(&quot;echo 3 &gt; /proc/sys/vm/drop_caches&quot;)
    luci.http.redirect(luci.dispatcher.build_url(&quot;admin&quot;, &quot;status&quot;, &quot;overview&quot;))
end
</code></pre><h3 id="在顶栏显示重启"><a href="#在顶栏显示重启" class="headerlink" title="在顶栏显示重启"></a>在顶栏显示重启</h3><p><em><code>feeds/luci/modules/admin-full/luasrc/controller/admin/system.lua</code></em></p>
<pre><code>function index()
    entry({&quot;admin&quot;, &quot;reboot&quot;}, call(&quot;action_reboot&quot;), _(&quot;Reboot&quot;), 90)
end
</code></pre><p><em><code>feeds/luci/modules/admin-full/luasrc/view/admin_system/reboot.htm</code></em><br>    </p><p><a href="<%=controller%>/admin/reboot?reboot=1">&lt;%:Perform reboot%&gt;</a></p>
<h3 id="在顶栏显示备份-升级"><a href="#在顶栏显示备份-升级" class="headerlink" title="在顶栏显示备份/升级"></a>在顶栏显示备份/升级</h3><p><em><code>feeds/luci/modules/admin-full/luasrc/controller/admin/system.lua</code></em></p>
<pre><code>function index()
    entry({&quot;admin&quot;, &quot;flashops&quot;}, call(&quot;action_flashops&quot;), _(&quot;Backup / Flash Firmware&quot;), 70)
end
</code></pre><h2 id="修改配置文件"><a href="#修改配置文件" class="headerlink" title="修改配置文件"></a>修改配置文件</h2><p><em><code>package/base-files/files/etc/</code></em><br>在这个目录里，你可以把你的备份的路由器导入进来</p>
<h3 id="修改-root-密码"><a href="#修改-root-密码" class="headerlink" title="修改 root 密码"></a>修改 root 密码</h3><p><em><code>package/base-files/files/etc/shadow</code></em></p>
<pre><code># 默认情况下 root 是没有密码的，需设定密码才能开启 ssh
root:$1$wEehtjxj$YBu4quNfVUjzfv8p/PBo5.:0:0:99999:7:::
</code></pre><h3 id="修改路由连接数"><a href="#修改路由连接数" class="headerlink" title="修改路由连接数"></a>修改路由连接数</h3><p><em><code>package/base-files/files/etc/sysctl.conf</code></em></p>
<pre><code>net.netfilter.nf_conntrack_max=65535
</code></pre><h3 id="修改主机名，设定时区"><a href="#修改主机名，设定时区" class="headerlink" title="修改主机名，设定时区"></a>修改主机名，设定时区</h3><p><em><code>package/base-files/files/etc/config/system</code></em></p>
<pre><code>config system
    # 设置主机名
    option hostname &apos;MakeBlaze&apos;
    option conloglevel &apos;8&apos;
    option cronloglevel &apos;8&apos;
    # 设置时区
    option zonename &apos;Asia/Shanghai&apos;
    option timezone &apos;CST-8&apos;

# 设置时间服务器
config timeserver &apos;ntp&apos;
    option enable_server &apos;1&apos;
    list server &apos;210.72.145.44&apos;
    list server &apos;s1a.time.edu.cn&apos;
    list server &apos;s1b.time.edu.cn&apos;
    list server &apos;202.120.2.101&apos;

config led &apos;usb_led&apos;
    option name &apos;USB&apos;
    option sysfs &apos;hg255d:usb&apos;
    option trigger &apos;usbdev&apos;
    option dev &apos;1-1&apos;
    option interval &apos;50&apos;

config led &apos;wlan_led&apos;
    option name &apos;WLAN&apos;
    option sysfs &apos;hg255d:wlan&apos;
    option trigger &apos;netdev&apos;
    option dev &apos;ra0&apos;
    option mode &apos;link tx&apos;

config led &apos;internet_led&apos;
    option name &apos;INTERNET&apos;
    option sysfs &apos;hg255d:internet&apos;
    option trigger &apos;netdev&apos;
    option dev &apos;eth0.2&apos;
    option mode &apos;tx rx&apos;
</code></pre><h3 id="SAMBA-免密码访问"><a href="#SAMBA-免密码访问" class="headerlink" title="SAMBA 免密码访问"></a>SAMBA 免密码访问</h3><p><em><code>package/base-files/files/etc/config/samba</code></em></p>
<pre><code>config samba
    # 显示中文
    option charset &apos;gb2312&apos;

config sambashare
    option read_only &apos;no&apos;
    option guest_ok &apos;yes&apos;
    option create_mask &apos;0777&apos;
    option dir_mask &apos;0777&apos;
    option display charset
</code></pre><p><em><code>package/base-files/files/etc/samba/smb.conf.template</code></em></p>
<pre><code>[global]
    netbios name = |NAME| 
    display charset = |CHARSET|
    interfaces = |INTERFACES|
    server string = |DESCRIPTION|
    unix charset = |CHARSET|
    workgroup = |WORKGROUP|
    browseable = yes
    deadtime = 30
    domain master = yes
    encrypt passwords = true
    enable core files = no
    guest account = root
    guest ok = yes
    # invalid users = root
    local master = yes
    load printers = no
    map to guest = Bad User
    max protocol = SMB2
    min receivefile size = 16384
    null passwords = yes
    obey pam restrictions = yes
    os level = 20
    passdb backend = smbpasswd
    preferred master = yes
    printable = no
    security = share
    smb encrypt = disabled
    # smb passwd file = /etc/samba/smbpasswd
    socket options = TCP_NODELAY IPTOS_LOWDELAY
    syslog = 2
    use sendfile = yes
    writeable = yes
</code></pre><h2 id="集成软件"><a href="#集成软件" class="headerlink" title="集成软件"></a>集成软件</h2><h3 id="添加-aria2，luci-添加，web-管理界面"><a href="#添加-aria2，luci-添加，web-管理界面" class="headerlink" title="添加 aria2，luci 添加，web 管理界面"></a>添加 aria2，luci 添加，web 管理界面</h3><p><code>aria2 http://sourceforge.net/projects/aria2/files/stable/</code></p>
<pre><code># aria2的依赖安装
sudo apt-get update 
sudo apt-get install autoconf automake libcppunit-dev autopoint openssl libtool sphinx-common sphinxsearch libgcrypt11-dev 
# 下载 aria2源码
cd dl
sudo apt-get install wget
wget http://sourceforge.net/projects/aria2/files/stable/aria2-1.18.7/aria2-1.18.7.tar.bz2
# 获取 md5码
md5sum aria2-1.18.7.tar.bz2
# 添加 luci-aria2
</code></pre><p>这里用的是南浦月的 luci-app-aira2和 webui-aria2<br><code>OpenWrt-Extra https://github.com/nanpuyue/openwrt-extra</code></p>
<pre><code>在 feeds.conf.default 中添加`src-git extra git://github.com/nanpuyue/openwrt-extra.git`
./scripts/feeds update -a
./scripts/feeds install -a
</code></pre><p>在 make menuconfig 中选中 aria2，luci-app-aira2和 webui-aria2就可以了</p>
<h3 id="添加将自己开发的程序"><a href="#添加将自己开发的程序" class="headerlink" title="添加将自己开发的程序"></a>添加将自己开发的程序</h3><p>在 package 下建立一个文件夹，以自己的项目命名，里边包括一个 files 文件夹和一个 Makefile 文件</p>
<pre><code>目录结构
&lt;ccnu&gt;
├Makefile
├&lt;files&gt;
│  ├&lt;etc&gt;
│  │  ├&lt;config&gt;
│  │  │  └ccnu
│  │  ├&lt;init.d&gt;
│  │  │  └ccnu
│  ├&lt;usr&gt;
│  │  ├&lt;lib&gt;
│  │  │  ├&lt;lua&gt;
│  │  │  │  ├&lt;luci&gt;
│  │  │  │  │  ├&lt;controller&gt;
│  │  │  │  │  │  └ccnu.lua
│  │  │  │  │  ├&lt;model&gt;
│  │  │  │  │  │  ├&lt;cbi&gt;
│  │  │  │  │  │  │  └ccnu.lua
│  │  ├&lt;sbin&gt;
│  │  │  └ccnu
</code></pre><p><em><code>package/ccnu/Makefile</code></em></p>
<pre><code>include $(TOPDIR)/rules.mk

PKG_NAME:=ccnu
PKG_VERSION:=2.0.1        
PKG_RELEASE:=1
PKG_BUILD_DIR := $(BUILD_DIR)/$(PKG_NAME)

include $(INCLUDE_DIR)/package.mk

define Package/ccnu
  SECTION:=utils
  CATEGORY:=Utilities
  SUBMENU:=H3C inode
  TITLE:= iNode Compatible Client for CCNU
  DEPENDS:=+libc +libgcc 
  MAINTAINER:= RiceLyn &lt;fjkfwz@gmail.com&gt;
endef

define Package/ccnu/description
    iNode Compatible Client for CCNU
endef

define Build/Prepare
endef

define Build/Configure
endef

define Build/Compile
endef

define Package/ccnu/install
    $(CP) ./files/* $(1)/
endef

$(eval $(call BuildPackage,ccnu))
</code></pre><p>之后./scripts/feeds install -a,ccnu 就会出现在 Utilities -&gt; H3C inode 里啦<br>这里先做一个简单的程序，以后会写文章详细介绍。</p>
<h2 id="HG255D-个性化配置"><a href="#HG255D-个性化配置" class="headerlink" title="HG255D 个性化配置"></a>HG255D 个性化配置</h2><h3 id="开启-HG255D-编译"><a href="#开启-HG255D-编译" class="headerlink" title="开启 HG255D 编译"></a>开启 HG255D 编译</h3><p><em><code>/target/linux/ramips/image/Makefile</code></em>去除 HG255D 前的<code>#</code></p>
<pre><code>Image/Build/Profile/HG255D=$(call BuildFirmware/Default16M/$(1),$(1),hg255d,HG255D)
$(call Image/Build/Profile/HG255D,$(1))
</code></pre><h3 id="make-menuconfig-配置"><a href="#make-menuconfig-配置" class="headerlink" title="make menuconfig 配置"></a>make menuconfig 配置</h3><pre><code># 选择编译对象
Target System (Ralink RT288x/RT3xxx)    —&gt;
Subtarget (RT3x5x/RT5350 based boards)  —&gt;
Target Profile (HuaWei HG255D)          —&gt;

# 添加 USB 挂载
Base system —&gt; &lt;*&gt;block-mount   

# 添加硬盘格式支持
Kernel modules —&gt; Filesystems —&gt; &lt;*&gt; kmod-fs-ext4 (移动硬盘 EXT4格式选择)
Kernel modules —&gt; Filesystems —&gt; &lt;*&gt; kmod-fs-vfat(FAT16 / FAT32 格式 选择)
Kernel modules —&gt; Filesystems —&gt; &lt;*&gt; kmod-fs-ntfs (NTFS 格式 选择)

# 添加 USB 相关支持
Kernel modules —&gt; USB Support —&gt; &lt;*&gt; kmod-usb-core.
Kernel modules —&gt; USB Support —&gt; &lt;*&gt; kmod-usb-ohci.
Kernel modules —&gt; USB Support —&gt; &lt;*&gt; kmod-usb-storage.
Kernel modules —&gt; USB Support —&gt; &lt;*&gt; kmod-usb-storage-extras.
Kernel modules —&gt; USB Support —&gt; &lt;*&gt; kmod-usb2.
Kernel modules —&gt; USB Support —&gt; &lt;*&gt; kmod-usb3.

# 添加自动挂载工具
Utilities —&gt; Filesystem —&gt; &lt;*&gt; badblocks

# 添加 UTF8编码,CP437编码，ISO8859-1编码
Kernel modules —&gt; Native Language Support —&gt; &lt;*&gt; kmod-nls-cp437
Kernel modules —&gt; Native Language Support —&gt; &lt;*&gt; kmod-nls-iso8859-1
Kernel modules —&gt; Native Language Support —&gt; &lt;*&gt; kmod-nls-utf8

# 添加 SCSI 支持
Kernel modules —&gt; Block Devices —&gt; &lt;*&gt;kmod-scsi-core

# 添加 LED 支持
LED modules  —&gt;
&lt; *&gt; kmod-ledtrig-usbdev…………………………. LED USB device Trigger

# 添加 luci
LuCI -&gt;Collections -&gt; &lt;*&gt; luci

# 添加 luci 的中文语言包
LuCI -&gt;Translations -&gt; &lt;*&gt; luci-i18n-chinese

# 添加 luci 应用
LuCI -&gt;Applications  —&gt; &lt;*&gt; luci-app-aria2……………………………… LuCI Support for aria2
LuCI -&gt;Applications  —&gt; &lt;*&gt; luci-app-ddns……………………… Dynamic DNS configuration module
LuCI -&gt;Applications  —&gt; &lt;*&gt; luci-app-samba……………….. Network Shares – Samba SMB/CIFS module
LuCI -&gt;Applications  —&gt; &lt;*&gt; luci-app-transmission…………………. LuCI Support for Transmission
</code></pre><h3 id="开启-POWER-LED-状态指示灯"><a href="#开启-POWER-LED-状态指示灯" class="headerlink" title="开启 POWER LED 状态指示灯"></a>开启 POWER LED 状态指示灯</h3><p><em><code>target\linux\ramips\base-files\etc\diag.sh</code></em></p>
<pre><code>get_status_led() {
    case $(ramips_board_name) in
+    hg255d)
+        status_led=&quot;hg255d:power&quot;
+        ;;
</code></pre><h3 id="使用-RA-MOD-软件源"><a href="#使用-RA-MOD-软件源" class="headerlink" title="使用 RA-MOD 软件源"></a>使用 RA-MOD 软件源</h3><p><em><code>RA-MOD https://github.com/ravageralpha/my_openwrt_mod</code></em></p>
<pre><code>feeds.conf.default
src-git ramod git://github.com/ravageralpha/my_openwrt_mod.git
# src-git luci http://git.openwrt.org/project/luci.git    

./scripts/feeds clean
./scripts/update -a
./scripts/install -a
</code></pre><h3 id="添加自动挂载脚本"><a href="#添加自动挂载脚本" class="headerlink" title="添加自动挂载脚本"></a>添加自动挂载脚本</h3><p><em><code>/package/base-files/files/etc/gotplug/block/30-block_mount</code></em></p>
<pre><code># !/bin/sh

# ---------------------------------------------------------------------
#  Filename:    30-block_mount
#  Revision:    0.5.1
#  Data:        Jul. 7, 2014
#  Email:       kevinyu@vip.qq.com
#  Contacts:    QQ/TM 389191 or mail address above
#  Licensing:   General Public License v2
#  Description: Created for automatic mount block devices on OpenWRT
#  Usage:       Put this script into directory /etc/hotplug.d/block
# ---------------------------------------------------------------------

## Global settings of auto-mount script ## 

#  Turn on|off auto-mount function for disk volumes
VOL_ENABLED=1  #  &lt;0|1  0-Disable, 1-Enable&gt;

#  Turn on|off auto-mount function for sawp partition  
SWAP_ENABLED=1  #  &lt;0|1  0-Disable, 1-Enable&gt;

#  Set which method you want to name the mounted volumes
USE_VLABEL=1  #  &lt;0|1  0-Use device name, 1-Use volume label&gt;  Eg. /mnt/sda1 | /mnt/DataDisk
# 
#  Note that if you choose name mount point by volume label but the volume&apos;s label is empty,
#  the volume will be named to &apos;volume_$PARTUUID&apos;, such as the /mnt/volume_31173116-01
#  Also, if exist more than one device which have the same volume label, it will be renamed 
#  as the original name + sequence number, such as the /mnt/DataDisk_n (n=1,2,3..9)

#  Show filesystem type as the prefix of mount point, requires set USE_VLABEL=1
FSTYPE_IN_VLABEL=1  #  &lt;0|1  0-Disable, 1-Enable&gt;  Eg. /mnt/[ntfs]-DataDisk

#  Set access the mounted device with read-write or read-only permission
FS_READONLY=0  #  &lt;0|1  0-Read Write, 1-Read Only&gt;

#  Exclusion list of auto-mount function
#  Allows mixing the device name, volume label and UUID, each item must be separated by space(s)
#  Eg. EXCLUDE_LIST=&quot;sda1 DataDisk f32b2ea6-4d42-43a5-bcec-7d818a163d07&quot; 
EXCLUDE_LIST=&quot;&quot;  #  Default: empty string

#  Specify a directory for mounts
MOUNTS_PATH=&quot;/mnt&quot;  #  Default: /mnt , don&apos;t need include the trailing slash (/)

#  Define the add-ons scripts directory for automatic execute
ADDSH_PATH=&quot;/etc/hotplug.d/user&quot;  #  Script naming rule: [0-9][0-9]-xxxxx, Eg. 20-backup-sdcard

## End of global settings ## 

#  Purge the directory MOUNTS_PATH
purge_mnts()
{
local i RETVAL
[ -d $MOUNTS_PATH ] || return 1
for i in $MOUNTS_PATH/* ; do
    if [ -d $i ] ; then
        if [ -z &quot;`ls -A $i 2&gt;&amp;-`&quot; ] ; then
            `grep -qs &quot;$i&quot; /proc/mounts` || { rm -rf $i 2&gt;/dev/null; RETVAL=$?; }
            if [ $RETVAL -eq 0 ] ; then
                logger -t Auto-Mount &quot;[Notice] Unused mount point $i was removed&quot;
                [ &quot;$CLI&quot; = &quot;yes&quot; ] &amp;&amp; echo &quot;[Notice] Unused mount point &apos;$i&apos; was removed&quot;
            else
                logger -t Auto-Mount &quot;[Error] Remove unused mount point $i failed&quot;
                [ &quot;$CLI&quot; = &quot;yes&quot; ] &amp;&amp; echo &quot;[Error] Remove unused mount point $i failed&quot;
            fi
        fi
    fi
done
}

#  Unmount all block device
umountall()
{
local i MOUNTS
MOUNTS=`grep -os &apos;^/dev/sd[a-z][1-9]&apos; /proc/mounts`
for i in $MOUNTS ; do
    umount -f $i
    [ $? -eq 0 ] &amp;&amp;    echo &quot;[Notice] Device $i unmounted&quot; | tee /proc/self/fd/2 | logger -t Auto-Mount
done
purge_mnts
}

#  Detect blkid exists
BLKID=`which blkid`
if [ $? -ne 0 ] ; then
    logger -t Auto-Mount &quot;[Error] Unable to mount block devices automatically because &apos;blkid&apos; does not exist&quot;
    exit 1
fi

MOUNTS_PATH=${MOUNTS_PATH%/}
[ -z &quot;$ACTION&quot; ] &amp;&amp; ACTION=${1## *-}
[ -n &quot;$DEVICENAME&quot; ] &amp;&amp; DEV=$DEVICENAME || DEV=$2
logger -t Auto-Mount &quot;[Debug] action=&apos;$ACTION&apos; devicename=&apos;$DEV&apos;&quot;
case &quot;$ACTION&quot; in
    add)
        [ -z &quot;$DEV&quot; ] &amp;&amp; { logger -t Auto-Mount &quot;[Error] Missing required arguments: \$devicename&quot;; exit 1; }
        if [ -n &quot;$EXCLUDE_LIST&quot; ] ; then
            UUID=`$BLKID -s UUID /dev/$DEV | awk -F &apos;=&apos; &apos;{print $NF}&apos; | tr -d &apos;&quot;| &apos;`
            VLABEL=`$BLKID -d -s LABEL /dev/$DEV | awk -F &apos;=&apos; &apos;{print $NF}&apos; | tr -d &apos;&quot;| &apos;`
            for i in $EXCLUDE_LIST ; do
                ignore=0
                if `echo &quot;$i&quot; | grep -qs &apos;^sd[a-z][1-9]$&apos;` ; then  #  is device name
                    [ $i = $DEV ] &amp;&amp; ignore=1
                elif `echo &quot;$i&quot; | grep -Eiqs &apos;^[0-9a-f]{8}(-[0-9a-f]{4}){3}-[0-9a-f]{12}$&apos;` ; then  #  is UUID
                    [ $i = $UUID ] &amp;&amp; ignore=1
                else  #  as volume label
                    [ $i = $VLABEL ] &amp;&amp; ignore=1
                fi
                [ $ignore -eq 1 ] &amp;&amp; { logger -t Auto-Mount &quot;[Notice] Device $DEV is ignored because it in exclusion list&quot;; exit 0; }
            done
        fi
        if `echo &quot;$DEV&quot; | grep -qs &apos;^sd[a-z][1-9]$&apos;` ; then
            [ -z &quot;$VLABEL&quot; ] &amp;&amp; VLABEL=`$BLKID -d -s LABEL /dev/$DEV | awk -F &apos;=&apos; &apos;{print $NF}&apos; | tr -d &apos;&quot;| &apos;`
            [ -z &quot;$VLABEL&quot; ] &amp;&amp; VLABEL=&quot;unknown&quot;
            FSTYPE=`$BLKID -s TYPE /dev/$DEV | awk -F &apos;=&apos; &apos;{print $NF}&apos; | tr -d &apos;&quot;| &apos;`
            logger -t Auto-Mount &quot;[Debug] devicename=&apos;$DEV&apos; volume_label=&apos;$VLABEL&apos; fstype=&apos;$FSTYPE&apos;&quot;
            MCMD=&quot;&quot;  #  set default value
            [ $FS_READONLY -eq 1 ] &amp;&amp; acs=&quot;ro&quot; || acs=&quot;rw&quot;
            case &quot;$FSTYPE&quot; in
                ext[234])
                    if `grep -vs &apos;^nodev&apos; /proc/filesystems | grep -qs &quot;$FSTYPE&quot;` ; then
                        MCMD=&quot;mount -t $FSTYPE -o ${acs},noatime&quot;
                    fi
                    ;;
                xfs|reiserfs)
                    if `grep -vs &apos;^nodev&apos; /proc/filesystems | grep -qs &quot;$FSTYPE&quot;` ; then
                        MCMD=&quot;mount -t $FSTYPE -o ${acs},noatime&quot;
                    fi
                    ;;
                iso9660|udf)
                    if `grep -vs &apos;^nodev&apos; /proc/filesystems | grep -qs &quot;$FSTYPE&quot;` ; then
                        MCMD=&quot;mount -t $FSTYPE -o ro&quot;
                    fi                    ;;
                vfat|msdos)
                    if `grep -vs &apos;^nodev&apos; /proc/filesystems | grep -qs &quot;$FSTYPE&quot;` ; then
                        MCMD=&quot;mount -t $FSTYPE -o ${acs},codepage=936,umask=000&quot;  # iocharset=utf8
                    fi
                    ;;
                exfat)
                    if `grep -Eqs &apos;^[[:space:]]+fuseblk$&apos; /proc/filesystems` &amp;&amp; `which mount.exfat &gt;/dev/null` ; then
                        MCMD=&quot;mount.exfat -o ${acs},iocharset=cp936,umask=000&quot;
                    fi
                    ;;
                ntfs)
                    if `grep -Eqs &apos;^[[:space:]]+fuseblk$&apos; /proc/filesystems` &amp;&amp; `which mount.ntfs-3g &gt;/dev/null` ; then
                        MCMD=&quot;mount -t ntfs-3g -o ${acs},noatime,big_writes,async,umask=000&quot;
                    fi
                    ;;
                swap)
                    [ $SWAP_ENABLED -ne 1 ] &amp;&amp; exit 0
                    if [ `grep -vs &apos;^Filename&apos; /proc/swaps | wc -l` -eq 0 ] ; then
                        MCMD=&quot;swapon /dev/$DEV&quot;
                    fi
                    ;;
                *)
                    MCMD=&quot;&quot;
                    ;;
            esac
            [ $VOL_ENABLED -ne 1 ] &amp;&amp; exit 0
            if [ $FSTYPE = &quot;swap&quot; ] ; then
                MOPT=&quot;&quot;
            elif [ $FSTYPE = &quot;iso9660&quot; -o $FSTYPE = &quot;udf&quot; ] ; then
                CDROM=&quot;cdrom&quot;
                if `grep -qs &quot;$MOUNTS_PATH/$CDROM &quot; /proc/mounts` ; then
                    SUFFIX=1
                    while `grep -qs &quot;$MOUNTS_PATH/$CDROM &quot; /proc/mounts` ; do
                        [ $SUFFIX -lt 10 ] &amp;&amp; CDROM=&quot;${CDROM%_*}_$SUFFIX&quot; || { CDROM=&quot;${CDROM%_*}_99&quot;; break; }
                        let SUFFIX++
                    done
                fi
                MPOINT=$CDROM
            else
                if [ $USE_VLABEL -eq 1 ] ; then
                    if [ $VLABEL = &quot;unknown&quot; ] ; then
                        PARTUUID=`$BLKID -s PARTUUID /dev/$DEV | awk -F &apos;=&apos; &apos;{print $NF}&apos; | tr -d &apos;&quot;| &apos;`
                        [ -z &quot;$PARTUUID&quot; ] &amp;&amp; PARTUUID=`cat /proc/sys/kernel/random/uuid | cut -f1 -d&apos;-&apos;`
                        VLABEL=&quot;volume_${PARTUUID}&quot;
                    elif `grep -qis &quot;$MOUNTS_PATH/$VLABEL &quot; /proc/mounts` ; then
                        SUFFIX=1
                        while `grep -qis &quot;$MOUNTS_PATH/$VLABEL &quot; /proc/mounts` ; do
                            if [ $SUFFIX -lt 10 ] ; then
                                VLABEL=&quot;$(echo &quot;$VLABEL&quot; | sed &apos;s/_[0-9]\+$//&apos;)_$SUFFIX&quot;
                                let SUFFIX++
                            else
                                VLABEL=&quot;$(echo &quot;$VLABEL&quot; | sed &apos;s/_[0-9]\+$//&apos;)_99&quot;
                                break
                            fi
                        done
                    fi
                    [ $FSTYPE_IN_VLABEL -eq 1 ] &amp;&amp; MPOINT=&quot;[${FSTYPE}]-${VLABEL}&quot; || MPOINT=$VLABEL
                else
                    MPOINT=$DEV
                fi
                MOPT=&quot;/dev/$DEV $MOUNTS_PATH/$MPOINT&quot;
            fi
            if [ -n &quot;$MCMD&quot; ] ; then
                if ! `grep -qs &apos;/dev/$DEV&apos; /proc/mounts` ; then
                    [ $FSTYPE = &quot;swap&quot; ] || { [ -d $MOUNTS_PATH/$MPOINT ] || mkdir -p $MOUNTS_PATH/$MPOINT; }
                    logger -t Auto-Mount &quot;[Debug] MountCMD=&apos;$MCMD $MOPT&apos;&quot;
                    #  echo &quot;[Debug] MountCMD=&apos;$MCMD $MOPT&apos;&quot; &gt;&gt; /tmp/auto-mount-debug
                    $MCMD $MOPT
                    RETVAL=$?
                    if [ $FSTYPE = &quot;swap&quot; ] ; then
                        if [ $RETVAL -eq 0 ] ; then
                            logger -t Auto-Mount &quot;[Notice] Swap device /dev/$DEV turned on&quot; 
                        fi
                    else
                        if [ $RETVAL -eq 0 ] ; then
                            logger -t Auto-Mount &quot;[Notice] Block device /dev/$DEV mounted on $MOUNTS_PATH/$MPOINT&quot; 
                        else
                            logger -t Auto-Mount &quot;[Warning] Re-try mount the block device /dev/$DEV after 2 seconds...&quot;
                            sleep 2
                            $MCMD $MOPT
                            if [ $? -eq 0 ] ; then
                                logger -t Auto-Mount &quot;[Notice] Block device /dev/$DEV mounted on $MOUNTS_PATH/$MPOINT&quot; 
                            else
                                rm -rf $MOUNTS_PATH/$MPOINT 2&gt;/dev/null
                                logger -t Auto-Mount &quot;[Error] Mount block device /dev/$DEV encounters an error&quot;
                                exit 1
                            fi
                        fi
                    fi
                fi
            else
                if [ $FSTYPE = &quot;swap&quot; ] ; then
                    logger -t Auto-Mount &quot;[Notice] Swap device /dev/$DEV was ignored&quot;
                else
                    logger -t Auto-Mount &quot;[Error] Unsupported filesystem &apos;$FSTYPE&apos; on /dev/$DEV&quot;
                fi
            fi
            unset MCMD
        fi
        purge_mnts
        ;;
    remove)
        [ -z &quot;$DEV&quot; ] &amp;&amp; { logger -t Auto-Mount &quot;[Error] Missing required arguments: \$devicename&quot;; exit 1; }
        if `echo &quot;$DEV&quot; | grep -qs &apos;^sd[a-z][1-9]$&apos;` ; then
            if `grep -qs &apos;/dev/$DEV&apos; /proc/mounts` ; then
                MPATH=`awk -F &apos; &apos; &apos;/\/dev\/&apos;&quot;$DEV&quot;&apos;/ {print $2}&apos; /proc/mounts 2&gt;/dev/null`
                umount /dev/$DEV
                [ $? -eq 0 ] &amp;&amp;    logger -t Auto-Mount &quot;[Notice] Block device $DEV unmounted&quot;
                [ -d &quot;$MPATH&quot; ] &amp;&amp; rm -rf $MPATH 2&gt;/dev/null
            fi
            if `grep -qs &apos;/dev/$DEV&apos; /proc/swaps` ; then
                swapoff $DEV
                [ $? -eq 0 ] &amp;&amp;    logger -t Auto-Mount &quot;[Notice] Swap device $DEV turned off&quot;                 
            fi            
        fi
        purge_mnts
        ;;
    umountall)
        CLI=&quot;yes&quot;
        umountall
        ;;
    purge)
        CLI=&quot;yes&quot;
        purge_mnts
        ;;
    *)
        echo &quot;[Error] ** Invalid action arguments: $ACTION&quot; | tee /proc/self/fd/2 | logger -t Auto-Mount
        ;;
esac

## Execute the add-ons script
#  ADDSH_PATH=&quot;$(cd &quot;$(dirname &quot;$0&quot;)&quot;; cd ..; pwd)/user&quot;
if [ -n &quot;`ls -A $ADDSH_PATH 2&gt;&amp;-`&quot; ]; then
    i=0
    for addsh in ${ADDSH_PATH}/[0-9][0-9]-* ; do
        [ $i -eq 0 ] &amp;&amp; logger -t Auto-Mount &quot;[Notice] -- Execute additional scripts ...&quot;
        logger -t Hotplug-Debug &quot;-- Exec script - $addsh&quot;
        sh $addsh $ACTION $DEV 
        let i++
    done
fi
#  Script EOF
</code></pre>
  </div>
</article>
<div class="blog-post-comments">
	<div class="wildfire_thread"></div>
</div>
    </div>
    
      <div id="footer-post-container">
  <div id="footer-post">

    <div id="nav-footer" style="display: none">
      <ul>
         
          <li><a href="/">Home</a></li>
         
          <li><a href="/about/">About</a></li>
         
          <li><a href="/archives/">Writing</a></li>
         
          <li><a href="http://github.com/fjkfwz">Projects</a></li>
         
          <li><a href="/Search/">Search</a></li>
        
      </ul>
    </div>

    <div id="toc-footer" style="display: none">
      <ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#Openwrt-基础编译"><span class="toc-number">1.</span> <span class="toc-text"><a href="#Openwrt-&#x57FA;&#x7840;&#x7F16;&#x8BD1;" class="headerlink" title="Openwrt &#x57FA;&#x7840;&#x7F16;&#x8BD1;"></a>Openwrt &#x57FA;&#x7840;&#x7F16;&#x8BD1;</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#Openwrt-编译进阶"><span class="toc-number">2.</span> <span class="toc-text"><a href="#Openwrt-&#x7F16;&#x8BD1;&#x8FDB;&#x9636;" class="headerlink" title="Openwrt &#x7F16;&#x8BD1;&#x8FDB;&#x9636;"></a>Openwrt &#x7F16;&#x8BD1;&#x8FDB;&#x9636;</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#修改-WIFI-设置"><span class="toc-number">2.1.</span> <span class="toc-text"><a href="#&#x4FEE;&#x6539;-WIFI-&#x8BBE;&#x7F6E;" class="headerlink" title="&#x4FEE;&#x6539; WIFI &#x8BBE;&#x7F6E;"></a>&#x4FEE;&#x6539; WIFI &#x8BBE;&#x7F6E;</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#修改-LUCI"><span class="toc-number">2.2.</span> <span class="toc-text"><a href="#&#x4FEE;&#x6539;-LUCI" class="headerlink" title="&#x4FEE;&#x6539; LUCI"></a>&#x4FEE;&#x6539; LUCI</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#修改-LUCI-界面配置"><span class="toc-number">2.2.1.</span> <span class="toc-text"><a href="#&#x4FEE;&#x6539;-LUCI-&#x754C;&#x9762;&#x914D;&#x7F6E;" class="headerlink" title="&#x4FEE;&#x6539; LUCI &#x754C;&#x9762;&#x914D;&#x7F6E;"></a>&#x4FEE;&#x6539; LUCI &#x754C;&#x9762;&#x914D;&#x7F6E;</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#添加释放内存"><span class="toc-number">2.2.2.</span> <span class="toc-text"><a href="#&#x6DFB;&#x52A0;&#x91CA;&#x653E;&#x5185;&#x5B58;" class="headerlink" title="&#x6DFB;&#x52A0;&#x91CA;&#x653E;&#x5185;&#x5B58;"></a>&#x6DFB;&#x52A0;&#x91CA;&#x653E;&#x5185;&#x5B58;</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#在顶栏显示重启"><span class="toc-number">2.2.3.</span> <span class="toc-text"><a href="#&#x5728;&#x9876;&#x680F;&#x663E;&#x793A;&#x91CD;&#x542F;" class="headerlink" title="&#x5728;&#x9876;&#x680F;&#x663E;&#x793A;&#x91CD;&#x542F;"></a>&#x5728;&#x9876;&#x680F;&#x663E;&#x793A;&#x91CD;&#x542F;</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#在顶栏显示备份-升级"><span class="toc-number">2.2.4.</span> <span class="toc-text"><a href="#&#x5728;&#x9876;&#x680F;&#x663E;&#x793A;&#x5907;&#x4EFD;-&#x5347;&#x7EA7;" class="headerlink" title="&#x5728;&#x9876;&#x680F;&#x663E;&#x793A;&#x5907;&#x4EFD;/&#x5347;&#x7EA7;"></a>&#x5728;&#x9876;&#x680F;&#x663E;&#x793A;&#x5907;&#x4EFD;/&#x5347;&#x7EA7;</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#修改配置文件"><span class="toc-number">2.3.</span> <span class="toc-text"><a href="#&#x4FEE;&#x6539;&#x914D;&#x7F6E;&#x6587;&#x4EF6;" class="headerlink" title="&#x4FEE;&#x6539;&#x914D;&#x7F6E;&#x6587;&#x4EF6;"></a>&#x4FEE;&#x6539;&#x914D;&#x7F6E;&#x6587;&#x4EF6;</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#修改-root-密码"><span class="toc-number">2.3.1.</span> <span class="toc-text"><a href="#&#x4FEE;&#x6539;-root-&#x5BC6;&#x7801;" class="headerlink" title="&#x4FEE;&#x6539; root &#x5BC6;&#x7801;"></a>&#x4FEE;&#x6539; root &#x5BC6;&#x7801;</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#修改路由连接数"><span class="toc-number">2.3.2.</span> <span class="toc-text"><a href="#&#x4FEE;&#x6539;&#x8DEF;&#x7531;&#x8FDE;&#x63A5;&#x6570;" class="headerlink" title="&#x4FEE;&#x6539;&#x8DEF;&#x7531;&#x8FDE;&#x63A5;&#x6570;"></a>&#x4FEE;&#x6539;&#x8DEF;&#x7531;&#x8FDE;&#x63A5;&#x6570;</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#修改主机名，设定时区"><span class="toc-number">2.3.3.</span> <span class="toc-text"><a href="#&#x4FEE;&#x6539;&#x4E3B;&#x673A;&#x540D;&#xFF0C;&#x8BBE;&#x5B9A;&#x65F6;&#x533A;" class="headerlink" title="&#x4FEE;&#x6539;&#x4E3B;&#x673A;&#x540D;&#xFF0C;&#x8BBE;&#x5B9A;&#x65F6;&#x533A;"></a>&#x4FEE;&#x6539;&#x4E3B;&#x673A;&#x540D;&#xFF0C;&#x8BBE;&#x5B9A;&#x65F6;&#x533A;</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#SAMBA-免密码访问"><span class="toc-number">2.3.4.</span> <span class="toc-text"><a href="#SAMBA-&#x514D;&#x5BC6;&#x7801;&#x8BBF;&#x95EE;" class="headerlink" title="SAMBA &#x514D;&#x5BC6;&#x7801;&#x8BBF;&#x95EE;"></a>SAMBA &#x514D;&#x5BC6;&#x7801;&#x8BBF;&#x95EE;</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#集成软件"><span class="toc-number">2.4.</span> <span class="toc-text"><a href="#&#x96C6;&#x6210;&#x8F6F;&#x4EF6;" class="headerlink" title="&#x96C6;&#x6210;&#x8F6F;&#x4EF6;"></a>&#x96C6;&#x6210;&#x8F6F;&#x4EF6;</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#添加-aria2，luci-添加，web-管理界面"><span class="toc-number">2.4.1.</span> <span class="toc-text"><a href="#&#x6DFB;&#x52A0;-aria2&#xFF0C;luci-&#x6DFB;&#x52A0;&#xFF0C;web-&#x7BA1;&#x7406;&#x754C;&#x9762;" class="headerlink" title="&#x6DFB;&#x52A0; aria2&#xFF0C;luci &#x6DFB;&#x52A0;&#xFF0C;web &#x7BA1;&#x7406;&#x754C;&#x9762;"></a>&#x6DFB;&#x52A0; aria2&#xFF0C;luci &#x6DFB;&#x52A0;&#xFF0C;web &#x7BA1;&#x7406;&#x754C;&#x9762;</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#添加将自己开发的程序"><span class="toc-number">2.4.2.</span> <span class="toc-text"><a href="#&#x6DFB;&#x52A0;&#x5C06;&#x81EA;&#x5DF1;&#x5F00;&#x53D1;&#x7684;&#x7A0B;&#x5E8F;" class="headerlink" title="&#x6DFB;&#x52A0;&#x5C06;&#x81EA;&#x5DF1;&#x5F00;&#x53D1;&#x7684;&#x7A0B;&#x5E8F;"></a>&#x6DFB;&#x52A0;&#x5C06;&#x81EA;&#x5DF1;&#x5F00;&#x53D1;&#x7684;&#x7A0B;&#x5E8F;</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#HG255D-个性化配置"><span class="toc-number">2.5.</span> <span class="toc-text"><a href="#HG255D-&#x4E2A;&#x6027;&#x5316;&#x914D;&#x7F6E;" class="headerlink" title="HG255D &#x4E2A;&#x6027;&#x5316;&#x914D;&#x7F6E;"></a>HG255D &#x4E2A;&#x6027;&#x5316;&#x914D;&#x7F6E;</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#开启-HG255D-编译"><span class="toc-number">2.5.1.</span> <span class="toc-text"><a href="#&#x5F00;&#x542F;-HG255D-&#x7F16;&#x8BD1;" class="headerlink" title="&#x5F00;&#x542F; HG255D &#x7F16;&#x8BD1;"></a>&#x5F00;&#x542F; HG255D &#x7F16;&#x8BD1;</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#make-menuconfig-配置"><span class="toc-number">2.5.2.</span> <span class="toc-text"><a href="#make-menuconfig-&#x914D;&#x7F6E;" class="headerlink" title="make menuconfig &#x914D;&#x7F6E;"></a>make menuconfig &#x914D;&#x7F6E;</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#开启-POWER-LED-状态指示灯"><span class="toc-number">2.5.3.</span> <span class="toc-text"><a href="#&#x5F00;&#x542F;-POWER-LED-&#x72B6;&#x6001;&#x6307;&#x793A;&#x706F;" class="headerlink" title="&#x5F00;&#x542F; POWER LED &#x72B6;&#x6001;&#x6307;&#x793A;&#x706F;"></a>&#x5F00;&#x542F; POWER LED &#x72B6;&#x6001;&#x6307;&#x793A;&#x706F;</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#使用-RA-MOD-软件源"><span class="toc-number">2.5.4.</span> <span class="toc-text"><a href="#&#x4F7F;&#x7528;-RA-MOD-&#x8F6F;&#x4EF6;&#x6E90;" class="headerlink" title="&#x4F7F;&#x7528; RA-MOD &#x8F6F;&#x4EF6;&#x6E90;"></a>&#x4F7F;&#x7528; RA-MOD &#x8F6F;&#x4EF6;&#x6E90;</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#添加自动挂载脚本"><span class="toc-number">2.5.5.</span> <span class="toc-text"><a href="#&#x6DFB;&#x52A0;&#x81EA;&#x52A8;&#x6302;&#x8F7D;&#x811A;&#x672C;" class="headerlink" title="&#x6DFB;&#x52A0;&#x81EA;&#x52A8;&#x6302;&#x8F7D;&#x811A;&#x672C;"></a>&#x6DFB;&#x52A0;&#x81EA;&#x52A8;&#x6302;&#x8F7D;&#x811A;&#x672C;</span></a></li></ol></li></ol></li></ol>
    </div>

    <div id="share-footer" style="display: none">
      <ul>
  <li><a class="icon" href="http://www.facebook.com/sharer.php?u=https://fjkfwz.github.io/2014/08/16/Openwrt-Compile-Pro/"><i class="fa fa-facebook fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="https://twitter.com/share?url=https://fjkfwz.github.io/2014/08/16/Openwrt-Compile-Pro/&text=Openwrt 编译进阶"><i class="fa fa-twitter fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://www.linkedin.com/shareArticle?url=https://fjkfwz.github.io/2014/08/16/Openwrt-Compile-Pro/&title=Openwrt 编译进阶"><i class="fa fa-linkedin fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="https://pinterest.com/pin/create/bookmarklet/?url=https://fjkfwz.github.io/2014/08/16/Openwrt-Compile-Pro/&is_video=false&description=Openwrt 编译进阶"><i class="fa fa-pinterest fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="mailto:?subject=Openwrt 编译进阶&body=Check out this article: https://fjkfwz.github.io/2014/08/16/Openwrt-Compile-Pro/"><i class="fa fa-envelope fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="https://getpocket.com/save?url=https://fjkfwz.github.io/2014/08/16/Openwrt-Compile-Pro/&title=Openwrt 编译进阶"><i class="fa fa-get-pocket fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://reddit.com/submit?url=https://fjkfwz.github.io/2014/08/16/Openwrt-Compile-Pro/&title=Openwrt 编译进阶"><i class="fa fa-reddit fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://www.stumbleupon.com/submit?url=https://fjkfwz.github.io/2014/08/16/Openwrt-Compile-Pro/&title=Openwrt 编译进阶"><i class="fa fa-stumbleupon fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://digg.com/submit?url=https://fjkfwz.github.io/2014/08/16/Openwrt-Compile-Pro/&title=Openwrt 编译进阶"><i class="fa fa-digg fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://www.tumblr.com/share/link?url=https://fjkfwz.github.io/2014/08/16/Openwrt-Compile-Pro/&name=Openwrt 编译进阶&description=&lt;p&gt;&lt;strong&gt;摘要&lt;/strong&gt;：这篇文章是 Openwrt 编译的学习笔记包括（1）Openwrt 基础入门（2）Openwrt 基础进阶（3）集成软件&lt;br&gt;"><i class="fa fa-tumblr fa-lg" aria-hidden="true"></i></a></li>
</ul>
    </div>

    <div id="actions-footer">
      <ul>
        <li id="toc"><a class="icon" href="#" onclick="$('#toc-footer').toggle();return false"><i class="fa fa-list fa-lg" aria-hidden="true"></i> TOC</a></li>
        <li id="share"><a class="icon" href="#" onclick="$('#share-footer').toggle();return false"><i class="fa fa-share-alt fa-lg" aria-hidden="true"></i> Share</a></li>
        <li id="top" style="display:none"><a class="icon" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast')"><i class="fa fa-chevron-up fa-lg" aria-hidden="true"></i> Top</a></li>
        <li id="menu"><a class="icon" href="#" onclick="$('#nav-footer').toggle();return false"><i class="fa fa-bars fa-lg" aria-hidden="true"></i> Menu</a></li>
      </ul>
    </div>

  </div>
</div>
    
    <footer id="footer">
  <div class="footer-left">
    Copyright &copy; 2017 masukio
  </div>
  <div class="footer-right">
    <nav>
      <ul>
         
          <li><a href="/">Home</a></li>
         
          <li><a href="/about/">About</a></li>
         
          <li><a href="/archives/">Writing</a></li>
         
          <li><a href="http://github.com/fjkfwz">Projects</a></li>
         
          <li><a href="/Search/">Search</a></li>
        
      </ul>
    </nav>
  </div>
</footer>
</body>
</html>
<!-- styles -->
<link rel="stylesheet" href="/lib/font-awesome/css/font-awesome.min.css">
<link rel="stylesheet" href="/lib/meslo-LG/styles.css">
<link rel="stylesheet" href="/lib/justified-gallery/justifiedGallery.min.css">
<!-- jquery -->
<script src="/lib/jquery/jquery.min.js"></script>
<script src="/lib/justified-gallery/jquery.justifiedGallery.min.js"></script>
<script src="/js/main.js"></script>
<!-- search -->

<!-- Google Analytics -->

    <script type="text/javascript">
        (function(i,s,o,g,r,a,m) {i['GoogleAnalyticsObject']=r;i[r]=i[r]||function() {
        (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
        m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
        })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
        ga('create', 'UA-86660611-1', 'auto');
        ga('send', 'pageview');
    </script>

<!-- Disqus Comments -->


<script>
  // 你可以自定义一些配置
  //
  // databaseProvider: 必须为 'wilddog' 或者 'firebase'
  // databaseConfig: 请从你的数据库控制台复制过来。
  // pageURL(可选): 默认为当前页面的 URL。
  // pageTitle(可选): 默认为当前页面的 title。
  // theme(可选): 'light'（默认）或者 'dark'。
  // locale(可选): 'en'（默认）或者 'zh-CN'
  // defaultAvatarURL(可选): 默认头像是一个可爱的消防员 :-D
  var wildfireConfig = () => ({
    databaseProvider: 'wilddog',
    databaseConfig: {
        siteId: "wd2882084211dpgrir"
    },
    theme: 'dark',
    locale: 'zh-CN',
    defaultAvatarURL: 'https://image.flaticon.com/icons/svg/621/621863.svg'
  })
</script>
<script src="https://unpkg.com/wildfire/dist/wildfire.auto.js"></script>